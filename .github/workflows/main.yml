name: Setup JGV-ER Repos
on: 
  workflow_dispatch:

jobs:
  create-repos:
    runs-on: ubuntu-latest
    steps:
      - name: Create Structure
        env:
          MY_TOKEN: ${{ secrets.MY_GITHUB_PAT }}
          USER: ${{ github.repository_owner }}
        run: |
          REPOS=("2k23" "2k24" "2k25")
          
          for REPO in "${REPOS[@]}"; do
            echo "Creating $REPO..."
            
            # 1. Create Repository
            curl -X POST -H "Authorization: token $MY_TOKEN" \
                 -H "Accept: application/vnd.github.v3+json" \
                 https://api.github.com/user/repos \
                 -d "{\"name\":\"$REPO\", \"auto_init\":true}"

            # Wait a few seconds for GitHub to initialize the repo
            sleep 5

            # 2. Add 1st-Sem subjects as an example 
            # (You can repeat this logic for all semesters/subjects)
            SUBJECTS=("Linear Algebra & Calculus" "Chemistry" "Introduction to Programming")
            
            for SUB in "${SUBJECTS[@]}"; do
              curl -X PUT -H "Authorization: token $MY_TOKEN" \
                   -H "Accept: application/vnd.github.v3+json" \
                   https://api.github.com/repos/$USER/$REPO/contents/1st-Sem/Mid-I/"$SUB".md \
                   -d "{\"message\":\"Add $SUB\", \"content\":\"$(echo "Syllabus for $SUB" | base64)\"}"
            done
          done
